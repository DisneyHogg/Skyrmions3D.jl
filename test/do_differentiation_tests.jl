
using Skyrmions

x2y3z4 = zeros(5,5,5,1)
for i in 1:5, j in 1:5, k in 1:5
    x2y3z4[i,j,k,1] = i^2*j^2 + 2.0*i^2*k^2 + 3.0*j^2*k^2
end

@test dxD(x2y3z4,1,3,3,3,1.0) ≈ 2.0*3^3 + 4.0*3^3
@test dyD(x2y3z4,1,3,3,3,1.0) ≈ (2.0 + 6.0)*3^3
@test dzD(x2y3z4,1,3,3,3,1.0) ≈ (4.0 + 6.0)*3^3

@test d2xD(x2y3z4,1,3,3,3,1.0) ≈ (2.0 + 4.0)*3^2
@test d2yD(x2y3z4,1,3,3,3,1.0) ≈ (2.0 + 6.0)*3^2
@test d2zD(x2y3z4,1,3,3,3,1.0) ≈ (4.0 + 6.0)*3^2

@test dxdyD(x2y3z4,1,3,3,3,1.0,1.0) ≈ 4.0*3^2
@test dxdzD(x2y3z4,1,3,3,3,1.0,1.0) ≈ 8.0*3^2
@test dydzD(x2y3z4,1,3,3,3,1.0,1.0) ≈ 12.0*3^2

